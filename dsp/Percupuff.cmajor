namespace Percupuff
{
    graph Percupuff  [[main]]
    {
        input event std::midi::Message midiIn;

        output stream float out;

        node
        {
            noise = std::noise::White;
            bassDrum = Drums::BassDrum;
            snare = Drums::Snare;
            hihat = Drums::Hihat;
            clap = Drums::Clap;
            cowbell = Drums::Cowbell;
            crash = Drums::Crash;
            claves = Drums::Claves;
            bongos = Drums::Bongos;
            gainLimiter = std::levels::ConstantGain (float, 1.0f);
            mpe = std::midi::MPEConverter;
        }
    
        connection
        {
            midiIn -> mpe;
            mpe -> bassDrum;
            mpe -> snare.eventIn;
            mpe -> hihat.eventIn;
            mpe -> clap.eventIn;
            mpe -> cowbell.eventIn;
            mpe -> crash.eventIn;
            mpe -> claves.eventIn;
            mpe -> bongos.eventIn;
            noise -> hihat.noiseIn;
            noise -> snare.noiseIn;
            noise -> clap.noiseIn;
            noise -> crash.noiseIn;
            noise -> claves.noiseIn;
            bassDrum -> gainLimiter;
            snare -> gainLimiter;
            hihat -> gainLimiter;
            clap -> gainLimiter;
            cowbell -> gainLimiter;
            crash -> gainLimiter;
            claves -> gainLimiter;
            bongos -> gainLimiter;
            gainLimiter -> out;
        }
    }
}
