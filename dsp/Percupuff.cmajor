namespace Percupuff
{
    graph Percupuff  [[main]]
    {
        input event std::midi::Message midiIn;

        output stream float out;

        node
        {
            noise = std::noise::White;
            bassDrum = Drums::BassDrum;
            snare = Drums::Snare;
            hihat = Drums::Hihat;
            clap = Drums::Clap;
            gainLimiter = std::levels::ConstantGain (float, 1.0f);
        }
    
        connection
        {
            midiIn -> std::midi::MPEConverter -> bassDrum;
            midiIn -> std::midi::MPEConverter -> snare;
            midiIn -> std::midi::MPEConverter -> hihat.eventIn;
            midiIn -> std::midi::MPEConverter -> clap.eventIn;
            noise -> hihat.noiseIn;
            noise -> clap.noiseIn;
            bassDrum -> gainLimiter;
            snare -> gainLimiter;
            hihat -> gainLimiter;
            clap -> gainLimiter;
            gainLimiter -> out;
        }
    }
}
