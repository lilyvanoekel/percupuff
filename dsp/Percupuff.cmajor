namespace Percupuff
{
    graph Percupuff  [[main]]
    {
        input event std::midi::Message midiIn;

        output stream float out;

        node
        {
            noise = std::noise::White;
            bassDrum = Drums::BassDrum;
            snare = Drums::Snare;
            hihat = Drums::Hihat;
            clap = Drums::Clap;
            cowbell = Drums::Cowbell;
            gainLimiter = std::levels::ConstantGain (float, 1.0f);
            mpe = std::midi::MPEConverter;
        }
    
        connection
        {
            midiIn -> mpe;
            mpe -> bassDrum;
            mpe -> snare.eventIn;
            mpe -> hihat.eventIn;
            mpe -> clap.eventIn;
            mpe -> cowbell.eventIn;
            noise -> hihat.noiseIn;
            noise -> snare.noiseIn;
            noise -> clap.noiseIn;
            bassDrum -> gainLimiter;
            snare -> gainLimiter;
            hihat -> gainLimiter;
            clap -> gainLimiter;
            cowbell -> gainLimiter;
            gainLimiter -> out;
        }
    }
}
